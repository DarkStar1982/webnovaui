<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>WebNOVA Mission Dashboard</title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,600,700,800" rel="stylesheet" />
  <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
  <!-- CSS Files -->
  <link href="assets/css/black-dashboard.css?v=1.0.0" rel="stylesheet" />
  <link href="assets/exodus/app_dash.css" rel="stylesheet" />
  <link href="assets/exodus/demo.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" crossorigin="" />
  <script type="text/javascript" src="node_modules/vue/dist/vue.min.js"></script>
  <script type="text/javascript" src="node_modules/vue-router/dist/vue-router.min.js"></script>
  <script type="text/javascript" src="assets/js/core/jquery.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" crossorigin=""></script>


  <script>
    var map;
    $(document).ready(function () {
      $("#dialog_text").hide();
      map = L.map('map').setView([46.19, 30.35], 12);
      L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
      }).addTo(map);
      var polygon = L.polygon([
        [46.205, 30.38],
        [46.175, 30.38],
        [46.175, 30.32],
        [46.205, 30.32]
      ]).addTo(map);
      $("#datepicker_start").datepicker();
      $("#datepicker_end").datepicker();
    });

    function request_pass_list()
    {
      var start_date_value = $("#datepicker_start").datepicker('getDate');
      var end_date_value = $("#datepicker_end").datepicker('getDate');
      var position = map.getCenter();

      var mission_data = {
        satellite: "None",
        instrument: "None",
        loc_lat: 11.214,
        loc_lon: 233.222,
        start_time: start_date_value,
        end_time: end_date_value
      }
      var api_str = "http://localhost:8000/webnova/v1/times_on_target/?norad_id=44878&net=2020,01,21,0,0,0&nlt=2022,02,14,1,1,1&lat=45.55&lng=30.5";
      $.get(api_str, function( data ) {
        var passes = JSON.parse(data)["target_passes"];
        for (var i=0;i<passes.length;i++)
        {
          $("#available_pass_list").append("<tr><td>"+passes[i][0]+"</td><td>"+passes[i][1]+'</td><td><input type="checkbox"/></td></tr>');
        }
        ///alert(data);
      });

      //$("#date_start").text(start_date_value.toLocaleDateString('en-US'));
      //$("#date_end").text(end_date_value.toLocaleDateString('en-US'));
      $("#target_lat").text(position.lat);
      $("#target_lon").text(position.lng);
    }

    function launch_mission()
    {
        //create a mission pass list
    }
  </script>
</head>

<body>
  <div class="content header-lane">
    <div class="row pl-5">
      <div class="col-12 text-left ml-1 logo-col-row pl-5">
        <a href="apps.html">
          <img class="logo" src="assets/img/logo-white.png">
          <h2>RGB Imager</h2>
        </a>
      </div>
    </div>
  </div>

  <div class="wrapper mt-5 mr-1 ml-1 apps-wrapper">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" id="home-tab" data-toggle="tab" href="#config" role="tab" aria-controls="home"
          aria-selected="true">Create</a>
      </li>
      </li>
    </ul>
    <div class="tab-content" id="myTabContent">
      <div class="tab-pane fade show active" id="config" role="tabpanel" aria-labelledby="home-tab">
        <div class="row map-row">
          <div class="col-12">
            <!-- DASHBOARD -->
            <br />
            <div class="row">
              <div class="col-lg-8 col-sm-8 map-col">
                <input class="form-control" type="text"  width="200px" id="search"/><br/>
                <div id="map"></div>
                <!--iframe width="100%" height="600" style="border:0" loading="lazy" allowfullscreen
            referrerpolicy="no-referrer-when-downgrade" src="https://www.google.com/maps/embed/v1/place?key=AIzaSyDhHE4gJ7D1s5chTxY_VA74SOh7dAjHAO0&q=Toronto">
          </iframe-->

              </div>
              <div class="col-lg-3 col-sm-3">
                <h4>Select the satellite</h4>
                <select id="satellites" class="form-control">
                  <option value="44878">TEST-SAT</option>
                </select><br/>
                <h4>Select instrument</h4>

                <select id="instruments" class="form-control">
                  <option value="1">RGB_IMAGER</option>
                </select><br/>
                <h4>Schedule Pass </h4>
                <table class="table">
                  <tr>
                    <td>Start Date: <input type="text" id="datepicker_start"></p></td>
                  </tr>
                  <tr>
                    <td>End Date:&nbsp;&nbsp; <input type="text" id="datepicker_end"></p></td>
                  </tr>
                </table>
                <button type="button" class="btn btn-info btn-lg button" data-toggle="modal" data-target="#myModal" onclick="request_pass_list()">Create Mission</button>
              </div>
            </div>
          </div>
        </div>

    </div>
    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel">Launch mission</h4>
          </div>
          <div class="modal-body">
              <table class="table table-dark">
                <tr>
                  <td>Target Latitude</td><td><span id="target_lat">0.00</span></td>
                </tr>
                <tr>
                  <td>Target Longitude</td><td><span id="target_lon">0.00</span></td>
                </tr>
                <!--tr>
                  <td>Start Date</td><td><span id="date_start"></span></td>
                </tr>
                <tr>
                  <td>End Date</td><td><span id="date_end"></td>
                </tr-->
              </table>
              <h4 class="text-dark">Select available passes</h4>
              <table class="table table-dark" id="available_pass_list">
                <tr>
                  <th class="text-white">Start Time</th><th class="text-white">End Time</th><th></th>
                </tr>
                <tr>
                  <td>2022-11-02 22:43:23</td><td>2022-11-03 03:41:13</td><td><input type="checkbox"/></td>
                </tr>
              </table>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Abort</button>
            <button type="button" class="btn btn-primary" data-dismiss="modal">Launch!</button>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!--   Core JS Files   -->
  <script type="text/javascript" src="assets/js/core/popper.min.js"></script>
  <script type="text/javascript" src="assets/js/core/bootstrap.min.js"></script>
  <script type="text/javascript" src="assets/js/plugins/chartjs.min.js"></script>
  <script type="text/javascript" src="assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <script type="text/javascript" src="assets/js/plugins/bootstrap-notify.js"></script>

  <script type="text/javascript" src="assets/js/black-dashboard.min.js?v=1.0.0"></script>
  <script type="text/javascript" src="assets/exodus/general.js"></script>
  <script type="text/javascript" src="assets/exodus/init.js"></script>
</body>

</html>
